- name: Roboshop Project -Frontend
  hosts: all
  become: true
  tasks:
    - name: Install Nginx
      ansible.builtin.yum:
        name: nginx
        state: installed

    - name: Copy RoboShop Configuration
      ansible.builtin.copy:
      src: nginx-roboshop.conf
      dest: /etc/nginx/default.d/roboshop.conf

    - name: Clean Old Content
      ansible.builtin.file:
        path: /usr/share/nginx/html
        state: absent

    - name: Create App Directory
      ansible.builtin.file:
      path: /usr/share/nginx/html
      state: directory

    - name: Download and extract the application Content
      ansible.builtin.unarchive:
        src: https://roboshop-artifacts.s3.amazonaws.com/frontend.zip
        dest: /usr/share/nginx/html
        remote_src: yes

    - name: Restart Nginx Service
      ansible.builtin.systemd:
        name: nginx
        state: restarted
        enabled: yes




#      source common.sh
#
#      echo -e "\e[36m>>>>>>>>>>>>>>>>>>>>>>>>>>>>install Nginx <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\e[0m"
#      dnf install nginx -y &>>${log}
#      func_exit_status
#
#      echo -e "\e[36m>>>>>>>>>>>>>>>>>>>>>>>>>>>>Copy RoboShop Configuration <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\e[0m"
#      cp nginx-roboshop.conf /etc/nginx/default.d/roboshop.conf &>>${log}
#      func_exit_status
#
#      echo -e "\e[36m>>>>>>>>>>>>>>>>>>>>>>>>>>>>Clean Old Content<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\e[0m"
#      rm -rf /usr/share/nginx/html/* &>>${log}
#      func_exit_status
#
#      echo -e "\e[36m>>>>>>>>>>>>>>>>>>>>>>>>>>>>Downloading Application Content <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\e[0m"
#      curl -o /tmp/frontend.zip https://roboshop-artifacts.s3.amazonaws.com/frontend.zip &>>${log}
#      func_exit_status
#
#      cd /usr/share/nginx/html
#
#      echo -e "\e[36m>>>>>>>>>>>>>>>>>>>>>>>>>>>>Extract Application Content<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\e[0m"
#      unzip /tmp/frontend.zip &>>${log}
#      func_exit_status
#
#      echo -e "\e[36m>>>>>>>>>>>>>>>>>>>>>>>>>>>>Start Nginx Service<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\e[0m"
#      systemctl enable nginx &>>${log}
#      systemctl restart nginx &>>${log}
#      func_exit_status